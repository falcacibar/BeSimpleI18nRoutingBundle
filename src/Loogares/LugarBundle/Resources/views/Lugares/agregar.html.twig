{% extends "::base.html.twig" %}

{% block title %}Agregar Lugar | {{parent()}}{% endblock %}

{% block stylesheets %}
    <style>

        .subcategorias{display: none;}

        .placeholder{
            color: #ccc;
        }

        input:focus, textarea{
            outline: none;
        }

        .input-active{
            border: 1px solid #3f0;
        }

        li.no-default{
            display: none;
        }   

        table td, table th{
            width: 10px !important;
            padding: 4px 2px;
        }
        table select{
            width: 80px !important;
        }

        table label{
            position: absolute;
            margin-left: 4px;
            margin-top: 2px;
            font-size: 10px;
        }

        .agregar-lugar .caracteristicas ul li,.agregar-lugar .subcategorias ul li{
            display: none;
        }


    </style>
{% endblock %}

{% block javascripts %}
    <script src="{{asset('assets/js/masterObject.js')}}"></script>
    <script src="{{asset('assets/js/googleMapAgregar.js')}}"></script>
    <script type="text/javascript" src='http://maps.google.com/maps?file=api&amp;v=2&amp;key=ABQIAAAAzlORVreqGpkqQqQvjPC0pBTqGAcz-UBEJ7apA_tMhekG0smvBRSy_IPIzC_OjDTx3IC5QK-ZXxFlmg&amp;sensor=false&amp;hl=es'></script>
    <script>
        $('.quitar').click(function(e){
            e.preventDefault();

            var $this = $(this);
                rel = $this.attr('rel') || '',
                count = 0;

            $this.parent().parent().fadeOut();
            $this.parent().parent().prev('li').find('span').fadeIn();

            if(rel.indexOf(['categoria', 'telefono'])){
                count = parseInt($('a.display-more-info[rel="'+rel+'"]').find('span').text());

                if(count == 0){
                    $('a.display-more-info[rel="'+rel+'"]').parent().parent().fadeIn().css('display', 'block');
                }

                $('a[rel='+rel+']').find('span').text(count + 1)
            }
        });

        $('.display-next-li').click(function(e){
            e.preventDefault(); 
            $(this).parent().parent().next('li').fadeIn().css('display', 'block');
            $(this).parent().fadeOut();
        });

        $('.display-more-info').click(function(e){
            e.preventDefault();
            
            var $this = $(this),
                rel = $this.attr('rel');
                count = parseInt($this.find('span').text()) - 1;
                if(count == 0){
                    $this.parent().parent().fadeOut();
                }

                if(count >= 0){
                    $('.'+rel+':not(:hidden):last').parent().next('li').fadeIn().css('display', 'block');
                    $this.find('span').text(count);
                }
        });


        $('.categoria').live('change', function(){
            $this = $(this);
            var categoria = $(this).val().camelCase(),
                anterior = selected[$this.attr('id')];

            //Deshabilitar en los demas dropdown
            $('.categoria').not($this).each(function(){
                //Deshabilitamos en el resto de los dropdowns el valor que seleccionamos recien
                $(this).find('option[value="'+$this.val()+'"]').attr('disabled', 'disabled').addClass(categoria);
                
                //Habilitamos el valor anterior
                $(this).find('option[value="'+selected[$this.attr('id')]+'"]').removeAttr('disabled');
            });

            $('.caracteristicas').parent().fadeOut();

            $('.categoria').not(':hidden').each(function(){
                var thisCat = $(this).val().camelCase(),
                    caracteristicas = categorias[thisCat].caracteristicas;
                    subCategorias = categorias[thisCat].subCategorias;

                if(caracteristicas != ''){
                    $('.caracteristicas').parent().fadeIn().css('display', 'block');
                }

                if(subCategorias != ''){
                    $this.parent().find('.subcategorias').stop(true,true).fadeIn().css('display', 'inline-block');
                }

                $.each(caracteristicas, function(i){
                    $('input[value="'+caracteristicas[i]+'"]').parent().parent().fadeIn();
                    $('.caracteristicas').parent().fadeIn();
                });

                if( anterior != undefined ){
                    //Por cada categoria que deshabilitamos
                    habilitar = categorias[anterior.camelCase()].deshabilitar;
                    $.each(habilitar, function(i){
                        $('.categoria').not($this).each(function(){
                            $aHabilitar = $(this).find('option[value="'+habilitar[i]+'"]');
                            //Por cada categoria, reviamos si otra Categoria la deshabilito, comprobamos si la clase que la deshabilito
                            //Es la ultima, si es, la habilitamos, si no, permanece deshabilitado
                            
                            if($aHabilitar.checkDefaultClass(anterior)){
                                //Enable it
                               $aHabilitar.removeAttr('disabled');
                            }
                        });
                    }); //End Habilitar

                    //Sacamos los camposo especiales.
                    camposEspeciales = categorias[anterior.camelCase()].camposEspeciales
                    $.each(camposEspeciales, function(i){
                        $('#form_'+camposEspeciales[i]).parent().fadeOut().css('display', 'block');
                    });

                    //Subcategorias
                }//end anterior
            });// end each

            $this.parent().find('.subcategorias ul li').fadeOut().find('input:checked').click();

            $.each(subCategorias, function(i){
                $this.parent().find('.subcategorias input[value="'+subCategorias[i]+'"]').parent().parent().stop(true, true).fadeIn().css('display', 'inline-block');
            });

            camposEspeciales = categorias[categoria].camposEspeciales
            $.each(camposEspeciales, function(i){
                $('#form_'+camposEspeciales[i]).parent().fadeIn().css('display', 'block');
            });

            $('.categoria').each(function(){
                var val = $(this).val().camelCase(),
                    $this = $(this);
                deshabilitar = categorias[val].deshabilitar;
                $.each(deshabilitar, function(j){
                    $('.categoria').not($this).each(function(i){
                        $(this).find('option[value="'+deshabilitar[j]+'"]').attr('disabled', 'disabled').addClass(val);
                    }); 
                });
            });
            
            //Seteamos el valor previo correspondiente al ID del dropdown que cambiamos
            selected[$this.attr('id')] = $this.val();
        });

        $('.jornada-doble').click(function(){
            if($(this).is(':checked')){
                $(this).parent().parent().parent().find('.horario-pm').fadeIn();
                $('table').find('th.horario-pm').fadeIn();
            }else{
                $(this).parent().parent().parent().find('.horario-pm').fadeOut();
                $('table').find('th.horario-pm').fadeOut();
            }
        });

        $('.habilitar-horario').click(function(){
            if($(this).is(':checked')){
                $(this).parent().next('li').fadeIn().css('display', 'block');
            }else{
                $(this).parent().next('li').fadeOut();
            }
        });


        //Validacion Subcategorias
        $('.subcategorias').change(function(e){
            $subcat = $(this).parent().find('.subcategoria');
            if($subcat.find(':checked').length == 3){
                $subcat.find(':not(:checked)').attr('disabled', 'disabled');
            }else if($subcat.find(':checked').length < 3){
                $subcat.find(':not(:checked)').removeAttr('disabled', 'disabled');
            }
        });

        $('.ciudad').change(function(){
            actualizarComunas();
        });

        $('form').submit(function(e){
            errores = '';
            $('.errors').remove();
            $.each($('.required:not(:hidden)'), function(){
                if(($(this).val() == $(this).attr('placeholder') || $(this).val() == '') || ($(this).val() == 'elige')){
                    errores += "<p>"+$(this).attr('title')+"</p>";
                    $(this).addClass('input-error');
                    if($(this).hasClass('calle')){
                        $(this).next('input').after('<small class="errors">'+$(this).attr('title')+'</small>');
                    }else{
                       $(this).after('<small class="errors">'+$(this).attr('title')+'</small>'); 
                    }
                    
                }else{
                    $(this).removeClass('input-error');
                }
            });

            if( !($('input[name="form[numero]"]').val().match(/(\d+|s\/n)/g)) ){
                errores += "<p>Ingrese solo numeros o s/n en el numero del Lugar</p>";
                $('input[name="form[numero]"]').addClass('input-error');
                $('input[name="form[numero]"]').after('<small class="errors">Ingrese solo numeros o s/n en el numero del Lugar</small>')
            }

            $.each($('.categoria:not(:hidden)'), function(){
                $this = $(this);
                if($this.parent().find('.subcategorias ul').children().length > 0){
                    if($this.parent().find('.subcategorias').find('ul > li').length > 0 && $this.parent().find('.subcategorias').find('ul > li > label').children(':checked').length == 0){
                        $this.addClass('input-error');
                        $this.parent().find('.subcategorias ul').after('<small class="errors categoria">Seleccione al menos una Subcategoria</small>');
                        errores += "<p>Seleccione al menos una Subcategoria por Categoria</p>";
                    }
                }
            });

            //Worst Conditional Ever
            if(
                ( $('.mapx').val() == '' || $('.mapy').val() == '' ) 
                && 
                ( $('.calle').val() != $('.calle').attr('placeholder') && $('.numero').val() != $('.numero').attr('placeholder'))
                && 
                $('.comuna').val() != 'elige')
                {
                errores += "<p>Cargue la direccion en el mapa, o arrastre el cursor donde esta el local</p>";
                $('.mapa_info').before('<small class="errors">Carga una direccion o arrastra el icono en el mapa.</small>');
            }

            $('.errores-container').html(errores);

            if(errores != ''){
                $('body').animate({'scrollTop': 0}, 400);
                $('.errores-container').fadeIn();
            }else{
                $('.placeholder').val('');
                return true;
            }
            return false;
        });

        $('.cargar-mapa').click(function(e){e.preventDefault();onCargarMapaAgregar();});

        /* Fncs */

        String.prototype.camelCase = function() {
            str = this;
            return str
                .replace(/[\s\-](.)/g, function($1) { return $1.toUpperCase(); })
                .replace(/[\s\-]/g, '')
                .replace(/^(.)/, function($1) { return $1.toLowerCase(); });
        }

        function actualizarComunas(){
            var ciudadSeleccionada = $('.ciudad > option:selected').text();
            $.each(optGroupComunas, function(i){
                if(optGroupComunas[i].match(ciudadSeleccionada)){
                    $('.comuna > optgroup').remove('optgroup');
                    $('.comuna').append(optGroupComunas[i]);
                }
            });

            $.each(optGroupSectores, function(i){
                if(optGroupSectores[i].match(ciudadSeleccionada)){
                    $('.sector > optgroup').remove('optgroup');
                    $('.sector').append(optGroupSectores[i]);
                }
            });
        }

        /* INITIALIZATION */

        var optGroupComunas = [],
            optGroupSectores = [],
            selected = {},
            caracteristicasASacar = [];

        $('input[type=text], textarea').each(function(){ $(this).placeholder() });

        $('.comuna > optgroup').each(function(i){
            optGroupComunas[i] = $(this).outerHTML();
            $(this).remove();
        });

        $('.sector > optgroup').each(function(i){
            optGroupSectores[i] = $(this).outerHTML();
            $(this).remove();
        });

        actualizarComunas();
       
        {% if editar %}
            $('.comuna').find('option[value="{{editar.comuna.slug}}"]').attr('selected', 'selected');
            $('.ciudad').find('option[value="{{editar.comuna.ciudad.slug}}"]').attr('selected', 'selected');
            {% if editar.sector %}$('.sector').find('option[value="{{editar.sector.slug}}"]').attr('selected', 'selected');{% endif %}
            onCargarMapaAgregar();

            {% for categoriaLugar in editar.categoriaLugar %}
                $currentSelect = $('.categoria').eq({{loop.index}}-1);
                $currentSelect.find('option[value="{{categoriaLugar.categoria.slug}}"]').attr('selected', 'selected').change();
                {% if loop.last == false %}$('a.display-more-info[rel=categoria]').click();{% endif %}

                {% for subcategoriaLugar in editar.subcategoriaLugar %}
                    {% if subcategoriaLugar.subcategoria.categoria.id == categoriaLugar.categoria.id %}
                        $currentSelect.parent().find('.subcategorias input[value="{{subcategoriaLugar.subcategoria.nombre}}"]').click();
                    {% endif %}
                {% endfor %}
            {% endfor %}

            {% for caracteristicaLugar in editar.caracteristicaLugar %}
                $('.caracteristicas').find('input[value="{{caracteristicaLugar.caracteristica.nombre}}"]').click();
            {% endfor %}
            
            
        {% else %}
            onCargarMapaAgregar('default');
        {% endif %}
    </script>
{% endblock %}

{% block content %}
<form action="{{ path('_agregar') }}" method="post" {{ form_enctype(form) }}>
{{ form_errors(form) }}

{% if errors %}
    <div class="errores">
        {% for error in errors %}
            <p>{{ error }}</p>
        {% endfor %}
    </div>
{% endif %}

<div class="errores-container"></div>
<ul class="agregar-lugar">
    <li>
        <label>Nombre</label>
        <input type="text" {% if editar %}value="{{editar.nombre}}"{%endif%} title="Ingresa el Nombre del Lugar" class="required" minlength="2" name="form[nombre]" id="form_nombre" placeholder="Ej. Bar El Tufo"/>
    </li>
    <li>
        <label>Categorias</label>
        {{ data.categoriaSelect | raw}}
        <div class='subcategorias'>
            <ul>
                {% for subCategoria in subCategorias %}
                    <li>
                        <label class="checkbox-label subcategoria">
                            <input type="checkbox" name="subcategoria[]" class="subcategoria" value="{{subCategoria.nombre}}" />
                            <span>{{subCategoria.nombre}}</span>
                        </label>
                    </li>
                {% endfor %}
            </ul>
        </div>
    </li>
    <li class="no-default">
        <label>Categorias</label>
        {{ data.categoriaSelect | raw}}
        <span class="quitar-info"><a class="quitar" rel="categoria" href="">Quitar</a></span>
        <div class='subcategorias'>
            <ul>
                {% for subCategoria in subCategorias %}
                    <li>
                        <label class="checkbox-label subcategoria">
                            <input type="checkbox" name="subcategoria[]" class="subcategoria" value="{{subCategoria.nombre}}" />
                            <span>{{subCategoria.nombre}}</span>
                        </label>
                    </li>
                {% endfor %}
            </ul>
        </div>
    </li>
    <li class="no-default">
        <label>Categorias</label>
        {{ data.categoriaSelect | raw}}
        <span class="quitar-info"><a class="quitar" rel="categoria" href="">Quitar</a></span>
        <div class='subcategorias'>
            <ul>
                {% for subCategoria in subCategorias %}
                    <li>
                        <label class="checkbox-label subcategoria">
                            <input type="checkbox" name="subcategoria[]" class="subcategoria" value="{{subCategoria.nombre}}" />
                            <span>{{subCategoria.nombre}}</span>
                        </label>
                    </li>
                {% endfor %}
            </ul>
        </div>
    </li>
    <li>        
        <span class="display-more"><a class="display-more-info" rel="categoria" href="">Otra categoria (Max 
        <span>2</span>)</a></span>
    </li>
    <li>
        <label>Ciudad</label>
        {{ data.ciudadSelect | raw}}
    </li>
    <li>
        <label>Comuna</label>
        {{ data.comunaSelect | raw}}
    </li>
    <li>
        <label>Direccion</label>
        <input type="text" {% if editar %}value="{{editar.calle}}"{%endif%} name="form[calle]" title="Ingresa la Calle del Lugar" class="calle required" id="form_calle" placeholder="Ej. Tarapallá"/>
        <input type="text" {% if editar %}value="{{editar.numero}}"{%endif%} name="form[numero]" class="numero required" title="Ingresa el Numero del Lugar" id="form_numero" placeholder="1949 o s/n"/>
    </li>
        <li>
         
                <span class="display-more"><a class="display-next-li" href="">Es parte de una galeria o centro comercial?</a></span>
         
            <span class="display-more"><a href="" class="cargar-mapa">Cargar Mapa</a></span>
    </li>
    <li class="no-default">
        <label>Detalle</label>
        <input type="text" {% if editar %}value="{{editar.detalle}}"{%endif%} name="form[detalle]" id="form_detalle" placeholder    ="Ej. Local 21, Mall Parque Arauco"/>
        
            <span class="quitar-info"><a class="quitar" href="">Quitar</a></span>
    </li>
    <li>
        <label>Sector</label>
        {{ data.sectorSelect | raw }}
    </li>
    <li>
        <label>Telefono</label>
        <span class="area-code"></span><input type="text" {% if editar %}value="{{editar.telefono1}}"{%endif%} name="form[telefono1]" id="form_telefono1" class="telefono" placeholder="Ej. +56 2 2130894"/>
    </li>
    <li class="no-default">
        <label>Telefono</label>
        <span class="area-code"></span><input type="text" {% if editar %}value="{{editar.telefono2}}"{%endif%} name="form[telefono2]" id="form_telefono2" class    ="telefono" placeholder="Ej. +56 2 2130894"/>
        
            <span class="quitar-info"><a class="quitar" rel="telefono" href="">Quitar</a></span>
    </li>
    <li class="no-default">
        <label>Telefono</label>
        <span class="area-code"></span><input type="text" {% if editar %}value="{{editar.telefono3}}"{%endif%} name="form[telefono3]" id="form_telefono3" class    ="telefono" placeholder="Ej. +56 2 2130894"/>
        
            <span class="quitar-info"><a class="quitar" rel="telefono" href="">Quitar</a></span>
    </li>
    <li>
            <span class="display-more"><a class="display-more-info" rel="telefono" href="">Mas telefonos (Max 
            <span>2</span>)</a></span>
    </li>
    <li>
        <label>Sitio Web</label>
        <input type="text" {% if editar %}value="{{editar.sitioWeb}}"{%endif%} name="form[sitio_web]" id="form_sitio_web" placeholder="Ej. http://www.bareltufo.cl"/>
    </li>
    <li>
        <label>Facebook</label>
        <input type="text" {% if editar %}value="{{editar.facebook}}"{%endif%} name="form[facebook]" id="form_facebook" placeholder="Ej. http://www.facebook.com/pages/bareltufo"/>
    </li>
    <li>
        <label>Twitter</label>
        <input type="text" {% if editar %}value="{{editar.twitter}}"{%endif%} name="form[twitter]" id="form_twitter" placeholder="Ej. http://www.twitter.com/barelfuto"/>
    </li>
    <li>
        <label>Mail</label>
        <input type="text" {% if editar %}value="{{editar.mail}}"{%endif%} name="form[mail]" id="form_mail" placeholder="Ej. usuario@logoares.com"/>
    </li>
    <li>
        <label>Horario</label>
        <small>Sabes los horarios de atencion?</small><input type="checkbox" name="habilitar-horario" class="habilitar-horario"/>
    </li>
   <li class="no-default">
        <table class="agregar-horarios">
            <thead>
                <th></th>
                <th>AM Abre</th>
                <th>AM Cierre</th>
                <th class="horario-pm">PM Abre</th>
                <th class="horario-pm">PM Cierre</th>
                <th></th>
            </thead>
            <tbody>
                <tr>
                    <td>Lunes</td>
                    <td>
                        <select name="horario-lunes[]">
                            {{ data.horarios | raw}}
                        </select>
                    </td>
                    <td>
                        <select name="horario-lunes[]">
                            {{ data.horarios | raw}}
                        </select>
                    </td>
                    <td class="horario-pm">
                        <select name="horario-lunes[]">
                            {{ data.horarios | raw}}
                        </select>
                    </td>
                    <td class="horario-pm">
                        <select name="horario-lunes[]">
                            {{ data.horarios | raw}}
                        </select>
                    </td>
                    <td><label><input type="checkbox" class="jornada-doble"> Jornada doble?</label></td> 
                </tr>
                <tr>
                    <td>Martes</td>
                    <td>
                        <select name="horario-martes[]">
                            {{ data.horarios | raw}}
                        </select>
                    </td>
                    <td>
                        <select name="horario-martes[]">
                            {{ data.horarios | raw}}
                        </select>
                    </td>
                    <td class="horario-pm">
                        <select name="horario-martes[]">
                            {{ data.horarios | raw}}
                        </select>
                    </td>
                    <td class="horario-pm">
                        <select name="horario-martes[]">
                            {{ data.horarios | raw}}
                        </select>
                    </td>
                    <td><label><input type="checkbox" class="jornada-doble"> Jornada doble?</label></td>
                </tr>
                <tr>
                    <td>Miercoles</td>
                    <td>
                        <select name="horario-miercoles[]">
                            {{ data.horarios | raw}}
                        </select>
                    </td>
                    <td>
                        <select name="horario-miercoles[]">
                            {{ data.horarios | raw}}
                        </select>
                    </td>
                    <td class="horario-pm">
                        <select name="horario-miercoles[]">
                            {{ data.horarios | raw}}
                        </select>
                    </td>
                    <td class="horario-pm">
                        <select name="horario-miercoles[]">
                            {{ data.horarios | raw}}
                        </select>
                    </td>
                    <td><label><input type="checkbox" class="jornada-doble"> Jornada doble?</label></td>
                </tr>
                <tr>
                    <td>Jueves</td>
                    <td>
                        <select name="horario-jueves[]">
                            {{ data.horarios | raw}}
                        </select>
                    </td>
                    <td>
                        <select name="horario-jueves[]">
                            {{ data.horarios | raw}}
                        </select>
                    </td>
                    <td class="horario-pm">
                        <select name="horario-jueves[]">
                            {{ data.horarios | raw}}
                        </select>
                    </td>
                    <td class="horario-pm">
                        <select name="horario-jueves[]">
                            {{ data.horarios | raw}}
                        </select>
                    </td>
                    <td><label><input type="checkbox" class="jornada-doble"> Jornada doble?</label></td>
                </tr>
                <tr>
                    <td>Viernes</td>
                    <td>
                        <select name="horario-viernes[]">
                            {{ data.horarios | raw}}
                        </select>
                    </td>
                    <td>
                        <select name="horario-viernes[]">
                            {{ data.horarios | raw}}
                        </select>
                    </td>
                    <td class="horario-pm">
                        <select name="horario-viernes[]">
                            {{ data.horarios | raw}}
                        </select>
                    </td>
                    <td class="horario-pm">
                        <select name="horario-viernes[]">
                            {{ data.horarios | raw}}
                        </select>
                    </td>
                    <td><label><input type="checkbox" class="jornada-doble"> Jornada doble?</label></td>
                </tr>
                <tr>
                    <td>Sabado</td>
                    <td>
                        <select name="horario-sabado[]">
                            {{ data.horarios | raw}}
                        </select>
                    </td>
                    <td>
                        <select name="horario-sabado[]">
                            {{ data.horarios | raw}}
                        </select>
                    </td>
                    <td class="horario-pm">
                        <select name="horario-sabado[]">
                            {{ data.horarios | raw}}
                        </select>
                    </td>
                    <td class="horario-pm">
                        <select name="horario-sabado[]">
                            {{ data.horarios | raw}}
                        </select>
                    </td>
                    <td><label><input type="checkbox" class="jornada-doble"> Jornada doble?</label></td>
                </tr>
                <tr>
                    <td>Domingo</td>
                    <td>
                        <select name="horario-domingo[]">
                            {{ data.horarios | raw}}
                        </select>
                    </td>
                    <td>
                        <select name="horario-domingo[]">
                            {{ data.horarios | raw}}
                        </select>
                    </td>
                    <td class="horario-pm">
                        <select name="horario-domingo[]">
                            {{ data.horarios | raw}}
                        </select>
                    </td>
                    <td class="horario-pm">
                        <select name="horario-domingo[]">
                            {{ data.horarios | raw}}
                        </select>
                    </td>
                    <td><label><input type="checkbox" class="jornada-doble"> Jornada doble?</label></td>
                </tr>
                <tr>
            </tbody>
        </table>
        <small>Si no se indica ningún horario para un determinado día, se entenderá que ese día está cerrado.
Si un día se indican los datos de Jornada 1, pero no los de Jornada 2, se entenderá que ese día opera en jornada única.</small>
    </li>
    <li class="no-default">
        <label>Profesional</label>
        <input type="text" {% if editar %}value="{{editar.profesional}}"{%endif%} name="form[profesional]" id="form_profesional" placeholder="Ej. Nombre del Arquitecto, Paisajista, etc"/>
    </li>
    <li class="no-default">
        <label>Año de Construccion</label>
        <input type="text" {% if editar %}value="{{editar.agnoConstruccion}}"{%endif%} name="form[agno_construccion]" id="form_agno_construccion" placeholder="Ej. 1985, Siglo XX"/>
    </li>
    <li class="no-default">
        <label>Descripcion</label>
        <textarea name="form[descripcion]" id="form_descripcion" placeholder="Breve Descripcion Blah Blah">{% if editar %} {{editar.descripcion}}{%endif%}</textarea>
    </li>
    <li class="no-default">
        <label>Materiales</label>
        <input type="text" {% if editar %}value="{{editar.materiales}}"{%endif%} name="form[materiales]" id="form_materiales" placeholder="Ej. Cobre, Granito, etc"/>
    </li>
    <li class="no-default">
        <label>Caracteristicas</label>
        <div class="caracteristicas">
            <ul>
                {% for caracteristica in caracteristicas %}
                    <li>
                        <label class="checkbox-label caracteristica">
                            <input type="checkbox" name="caracteristica[]" class="caracteristica" value="{{caracteristica.nombre}}" />
                            <span>{{caracteristica.nombre}}</span>
                        </label>
                    </li>
                {% endfor %}
            </ul>
        </div>
    </li>
    <li>
        <input type="hidden" class="mapx" {% if editar %}value="{{editar.mapx}}"{%endif%} name="form[mapx]" id="form_mapx"/>
        <input type="hidden" class="mapy" {% if editar %}value="{{editar.mapy}}"{%endif%} name="form[mapy]" id="form_mapy"/>
    </li>
    <li><input type="submit" value="Guardar Datos" formnovalidate/></li>
</ul>
<div class="mapa_agregar">
    <div id="mapa" class="gmaps">

    </div>
    <div class="mapa_info">
        <span>Ubicación en el mapa</span>
        Una vez cargado el mapa, puedes arrastrar el ícono para corregir su posición.
    </div>
</div>
{{ form_widget(form._token) }}



</form>
{% endblock %}