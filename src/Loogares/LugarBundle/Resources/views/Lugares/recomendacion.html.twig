<script>
	$(document).ready(function(){
		$('.recomendacion-star-raty').raty({
	        width: 140,
	        starOff:  WEBROOT+'../assets/images/extras/estrella_vacia_recomendacion.png',
	        starOn:   WEBROOT+'../assets/images/extras/estrella_llena_recomendacion.png',
	        starHalf:   WEBROOT+'../assets/images/extras/estrella_media_recomendacion.png',
	        half: true,
	        start: {{recomendacion.estrellas | default(0)}},
	        space: false,
	       	hintList: hintListEstrellas,
	       	target: '#estrellas-recomienda',
	        scoreName: 'recomienda-estrellas'
	    });

	    $('.recomendacion-precio-raty').raty({
	        width: 140,
	        starOff:  WEBROOT+'../assets/images/extras/precio_vacio.png',
	        starOn:   WEBROOT+'../assets/images/extras/precio_lleno.png',
	        start: {{recomendacion.precio | default(0)}},
	        space: false,
	        hintList: ['Menos de $3.000', '$3.000 - $7.000', '$7.000 - $12.000', '$12.000 - $18.000', 'Mas de $18.000'],
	        target: '#precio-recomienda',
	        scoreName: 'recomienda-precio'
	    });

		$('.texto').keyup(function(){
		    $('.max').text(3000 - parseInt($(this).val().length));
		    $('.llevas').text(parseInt($(this).val().length));
		});

		$('.texto').keyup()

	    $('[name="recomienda"]').submit(function(){
	    	if(validarRecomendacion()){
	    		return true
	    	}else{
	    		return false
	    	}
	    });
	});

		function validarRecomendacion(){
	    	var error = false;
	    	$('.errors').remove();
	    	$('.input-error').removeClass('input-error');
	    	if($('.texto').val().length < 250){
	    		error = true;
	    		$('.texto').addClass('input-error');
	    		$('.texto').parent().append("<small class='errors'>Minimo de 255 Chars</small>");
	    	}

	    	if($('[name="recomienda-precio"]').val() == 0){
	    		error = true;
	    		$('.recomendacion-precio-raty').parent().append("<small class='errors'>Debes darle al menos medio valor al Precio!</small>")
	    	}
	    	
	    	if($('[name="recomienda-estrellas"]').val() == 0){
	    		error = true;
	    		$('.recomendacion-star-raty').parent().append("<small class='errors'>Debes darle al menos medio valor!</small>")
	    	}

	    	if(error){
	    		return false;
	    	}else{
	    		return true;
	    	}
	    }
</script>

<h3 class="titulo_recomendaciones">{{'lugar.ficha.recomienda.titulo'|trans}} {{ lugar.nombre }}</h3>

<form class="recomienda_lugar" name="recomienda" action="{{ path('_recomienda', {'slug': lugar.slug}) }}" method="post">
	<ul>
		<li>
			<label>{{'lugar.recomendacion.evaluacion'|trans}}</label>
			<div class="recomendacion-star-raty recomienda_estrellas"></div>
			<div id="estrellas-recomienda"></div>
		</li>
		{% if lugar is defined or recomendacion is defined %} <!-- Cuando aplican las categorÃ­as -->
		<li>
			<label>{{'lugar.recomendacion.precio'|trans}}</label> 
			<div class="recomendacion-precio-raty recomienda_precio"></div>
			<div id="precio-recomienda"></div>
		</li>
		{% endif %}
		<li>
			<label>
				{{'lugar.recomendacion.titulo'|trans}}
				<span class="detalle_maximo_caracteres_recomendacion">({{'lugar.recomendacion.maximo'|trans}} <span class="max">3000</span> / <span class="detalle_llevas_caracteres_recomendacion">{{'lugar.recomendacion.llevas'|trans}} <span class="llevas">0</span></span>)</span>
			</label> 
			<textarea placeholder="{{'lugar.recomendacion.placeholders.textarea'|trans}}" name="texto" class="texto" cols="30" rows="10">{% if recomendacion is defined %}{{recomendacion.texto}}{% endif %}</textarea>
		</li>
		<li>
			<label>{{'lugar.recomendacion.tags'|trans}}</label> 
			<input placeholder="{{'lugar.recomendacion.placeholders.tags'|trans}}" name="tags" type="text" class="tags" value="{% if recomendacion is defined %}{% for tagRecomendacion in recomendacion.tagRecomendacion %}{{tagRecomendacion.tag.tag}}{% if loop.last != true %}, {% endif %}{% endfor %}{% endif %}"/>
		</li>
		{% if lugar is defined and lugar.tagsPopulares is defined and lugar.tagsPopulares|length > 0 %}
		<li>
		    <label>{{'lugar.recomendacion.tagsPopulares'|trans}}</label>
            {% for tagsPopulares in lugar.tagsPopulares %}
                <a class="link_azul" href="#">{{tagsPopulares.nombre}}</a>{% if loop.last == false %}, {% endif %}
            {% endfor %}
		</li>
		{% endif %}
	</ul>
	{% if lugar.slug  %}
		<input class="enviar_recomendacion" type="submit" value=""/>
	{% endif %}
</form>


