{% extends "::base.html.twig" %}

{% block title %}{{parent()}} | {{'general.home.title'|trans}}{% endblock %}

{% block ads %}
    <script type='text/javascript' src='http://partner.googleadservices.com/gampad/google_service.js'></script>
    <script type='text/javascript'>
        GS_googleAddAdSenseService("{{adsense_service}}");
        GS_googleEnableAllServices();
    </script>
    <script type='text/javascript'>
        GA_googleAddSlot("{{adsense_service}}", "{{ad('static','home','top','medium')}}");
    </script>
    <script type='text/javascript'>
        GA_googleFetchAds();
    </script>
{% endblock %}

{% block content %}

	<!-- Si el usuario está conectado, debe mostrar un cambio en la caja -->
	<div class="saludos_premios">

		<!-- Está caja se alarga si el usuario está en sesión -->
		<div class="{% if app.security.token.user.id is defined %}mensaje_logeado{% else %}mensaje{% endif %}">
			<h1><strong>{{'general.home.saludo_bienvenida'|trans}}</strong></h1>

			<p>{{'general.home.actividad_loogares.actualmente'|trans}} <span class="texto_destacado">{{home.totalRecomendaciones_format}} {{'general.home.actividad_loogares.recomendaciones'|transchoice(home.totalRecomendaciones)}}</span> {{'general.home.actividad_loogares.y'|trans}} <span class="texto_destacado">{{home.totalPremios_format}} {{'general.home.actividad_loogares.premios'|transchoice(home.totalPremios)}}</span> {{'general.home.actividad_loogares.participa'|trans}}</p>
		</div>

		{% if app.security.token.user.id is defined %} 

		{% else %}
			<!-- Las cajas de clase "flecha" y "registro" se van cuando el usuario está en sesión -->
			<div class="flecha">
			</div>

			<div class="registro">
	            <a href="#">
	                <div class="boton_fb"></div>
	            </a>
	            <p class="registro_mail">{% trans %}usuario.login.registro.o{% endtrans %} <a href="{{path('registroUsuario')}}">{% trans %}usuario.login.registro.mail{% endtrans %}</a></p>
			</div>
		{% endif %}

	</div>

	<!-- Contenido central -->
	<div class="contenido_home">
		<div class="campanas_concursos">
			<ul>
				<a href="">
					<li>
						<h2 class="titulo_concurso concursos">Concurso: Sólo por hoy</h2>
						<img src="http://www.animalesyanimales.com/wp-content/uploads/2011/05/animales1.jpg" width="204" height="124" / >
						<p class="lugar_concurso">Centro Cultural Amanda</p>
						<p class="sorteo_concurso">Sorteamos 5 entradas dobles para La Mano Ajena</p>
					</li>
				</a>
				<a href="">
					<li class="central">
						<h2 class="titulo_concurso especiales">Concurso: Sólo por hoy</h2>
						<img src="http://www.animalesyanimales.com/wp-content/uploads/2011/05/animales1.jpg" width="204" height="124" / >
						<p class="lugar_concurso">Centro Cultural Amanda</p>
						<p class="sorteo_concurso">Sorteamos 5 entradas dobles para La Mano Ajena</p>
					</li>
				</a>
				<a href="">
					<li>
						<h2 class="titulo_concurso ganadores">Concurso: Sólo por hoy</h2>
						<img src="http://www.animalesyanimales.com/wp-content/uploads/2011/05/animales1.jpg" width="204" height="124" / >
						<p class="lugar_concurso">Centro Cultural Amanda</p>
						<p class="sorteo_concurso">Sorteamos 5 entradas dobles para La Mano Ajena</p>
					</li>
				</a>
			</ul>
		</div>

		{% render 'LoogaresLugarBundle:Lugar:moduloDescuentos' with {'ciudad' : app.session.get('ciudad').id, 'pagina' : 'home'}%}

	</div>

	<!-- Sidebar -->
	<div class="sidebar_home">

		<!-- Banner Home -->
		<div class="banner_300x250">
			<script type='text/javascript'>
            	GA_googleFillSlot("{{ad('static','home','top','medium')}}");
        	</script>
		</div>

	</div>





	<div id="home">

		<div class="columna_der">
			<div class="recomendacion_dia">
				<h2>{{'general.home.recomendacion_dia.titulo'|trans}}</h2>
				<div class="recomendacion_info">
					<a href="{{path('showUsuario', {'param' : (home.recDia.usuario.slug is not empty) ? home.recDia.usuario.slug : home.recDia.usuario.id})}}" class="link_usuario">
						<img src="{{('assets/images/usuarios/'~home.recDia.usuario.imagenFull) | apply_filter('small_usuario')}}" height="60" width="60"/>
					</a>
					<div class="usuario_recomendacion">
						<a href="{{path('showUsuario', {'param' : (home.recDia.usuario.slug is not empty) ? home.recDia.usuario.slug : home.recDia.usuario.id})}}">{{home.recDia.usuario.nombre}} {{home.recDia.usuario.apellido}}</a>
						<span>{{home.recDia.fechaCreacion | date('d/m/Y')}}</span>
						<p class="estrellas_recDia" data-stars="{{home.recDia.estrellas}}"></p>
					</div>
				</div>
				<div class="recomendacion_preview">					
					<span><a href="{{path('_lugar', {'slug' : home.recDia.lugar.slug})}}">{{home.recDia.lugar.nombre}}: </a>{{home.previewRecDia}}</span>
					<a href="{{path('_recomendacion', {'slug' : home.recDia.lugar.slug, 'usuarioSlug' : (home.recDia.usuario.slug is not empty) ? home.recDia.usuario.slug : home.recDia.usuario.id})}}" class="ver_mas">{{'general.home.recomendacion_dia.ver_mas'|trans}} &raquo;</a>
				</div>
			</div>
			<div class="ultimos_conectados">
				<h2>{{'general.home.ultimos_conectados.titulo'|trans}}</h2>
				{% if home.ultimosConectados|length > 0%}
					<ul>
					{% for conectado in home.ultimosConectados %}
						<li>
							<a href="{{path('showUsuario', {'param' : (conectado.slug is not empty) ? conectado.slug : conectado.id})}}" class="conectado_img">
								<img src="{{('assets/images/usuarios/'~conectado.imagenFull) | apply_filter('tiny_usuario')}}" width="20" height="20" />
							</a>
							<div class="conectado_info">
								<a href="{{path('showUsuario', {'param' : (conectado.slug is not empty) ? conectado.slug : conectado.id})}}" class="conectado_nombre">{{conectado.nombre}} {{conectado.apellido}}</a>
								<span class="conectado_recomendaciones">{{conectado.recomendaciones|length}} {{'general.terminos.recomendacion' | transchoice(conectado.recomendaciones|length) | lower }}</span>
							</div>
						</li>
					{% endfor %}
					</ul>
				{% endif %}
			</div>
		</div>		
	</div>
{% endblock %}

{% block javascripts %}
	<script src="{{asset('assets/js/jquery.raty.min.js')}}"></script>
	<script src="{{asset('assets/js/home.js')}}"></script>
{% endblock %}